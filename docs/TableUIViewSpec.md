# TableUIView仕様

## できる操作(動作チェックリスト)

- セルをクリックして選択状態にできる
  - Text, Numberはセルのどこをクリックしても選択状態に
  - Checkboxはチェックボックス以外の領域をクリックした場合に選択状態に
    - チェックボックスをクリックした場合は選択状態は変化せずに値が変更される
  - Selectはセルのどこをクリックしても選択状態に
    - ドロップダウンアイコン(右の逆三角形)をクリックした場合も選択状態にしつつ、選択肢を表示する
- あるセルを選択した状態で別のセルをShiftキーを押しながらクリックした場合、範囲選択になる
  - 以下のどの順番でも可能
    - 上から下
    - 下から上
    - 右から左
    - 左から右
  - 2回連続でshift押しながら選択した場合、最後にクリックしたセルと最初の選択したセルを基準に選択範囲を更新する。
  - セルが一つも選択されていない状態でshiftを押しながらクリックした場合、選択状態にならない
- セルをドラッグすると範囲選択できる。(最初にクリックしたセルとドラッグ中のカーソルのあるセルを基準)
  - ドラッグ中にカーソルがテーブルの範囲外に移動した場合は選択範囲は更新されない
    - 再びテーブルの中にカーソルが戻ってきたときには選択範囲の更新が再開される
  - マウスの左ボタンを離した時点で選択範囲が確定する
    - マウスカーソルがテーブル内、テーブル外のどちらにあっても同様に動作する
- テーブルの外側をクリックした時点で選択範囲をクリアする
  - 編集中だったテキストはクリアする直前の状態で確定する
    - ただし、Selectの場合には選択は行われない
- 選択状態からキーボード入力するとテキスト編集が始まる
  - 対象のセルはText, Number, Select
  - テキスト編集開始時点でIMEも有効
- セルからのコピーペーストが可能
  - 選択範囲をコピー可能
  - 選択範囲をコピーした後、ペーストすると範囲ペーストになる
    - 範囲ペースト時に行数が足りない場合、自動で追加される
  - 範囲選択してペーストすると以下のルールでできるだけ選択範囲に沿ったペーストを行う
    - 以下のルールを行と列それぞれに独立に適用して実際のペースト範囲を決定する
    - コピー範囲 > ペースト範囲指定の場合、コピー範囲まで拡張する
    - コピー範囲 < ペースト範囲指定の場合、コピー範囲の整数倍かつペースト範囲指定を上回らない範囲の最大範囲に制限する
      - 例えばコピー範囲が2つでペースト範囲指定が5つだった場合、実際のペースト範囲は4(2*2)になる。
- 選択状態で以下のキー操作が可能
  - deleteキー押下で選択対象のセルのクリア (未)
  - enterキー押下で編集モードに移行 (未)
  - tabキー押下で右のセルを選択 (未)
    - shiftキーを押下しながらの場合、左のセルを選択 (未)
- 編集モードで以下のキー操作が可能
  - enterキー押下で下のセルを選択 (未)
    - shiftキーを押下しながらの場合、上のセルを選択 (未)
    - altキーを押下しながらの場合、編集中のセルで改行を入力 (未)
      - ただし、multiline許可のテキスト形式の場合のみ
  - tabキー押下で右のセルを選択 (未)
    - shiftキーを押下しながらの場合、左のセルを選択 (未)
